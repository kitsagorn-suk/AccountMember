@model account.Models.LoginModel

@{
    ViewBag.Title = "Login";
    Layout = null;
    <title>askmebet</title>
    <link rel="icon" href="../img/logo-icon.jpeg" type="image/ico" />
}
@using (Html.BeginForm())
{
    <!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=1480" />
        <meta http-equiv="x-ua-compatible" content="ie=edge" />
        <link href="../Content/bootstrap.min.css" rel="stylesheet" />
        <link href="../Content/style.css" rel="stylesheet" />
        <link href="../Content/styles/mdb.min.css" rel="stylesheet" />
        @*<script src="../Scripts/jquery-3.6.0.min.js"></script>*@
    </head>
    <body class="login-page">

        <div id="myModalLoad" class="modal" data-backdrop="static" data-keyboard="false">
            <div class="d-flex justify-content-center" style="position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); color: #CFA137 !important;">
                <div class="spinner-border" role="status" style="width: 10rem; height: 10rem; font-size: 5rem;">
                    <span class="sr-only">Loading...</span>
                </div>
            </div>
        </div>

        <form class="login-page">
            <div class=" h-100 d-flex justify-content-center align-items-center">
                <div class="login-section">
                    <div class="card">
                        <div class="login-footer pt-4" style="padding-top: 1rem !important; border-bottom: 1px #fff solid; padding-bottom: 1rem !important;">
                            <a style="color: #fff;" id="txtLan">ไทย<img src="~/img/thailand.png" style="width: 20px; margin-left: .4rem;"></a>
                            <div id="divblock" style="display: none; left: 12.2rem;">
                                <div style="border-bottom: 1px #ddd solid; padding: 3px;">
                                    <a onclick="SetLanguage('Thai');">
                                        <img src="../img/thailand.png" style="width: 20px;"> ไทย
                                    </a>
                                </div>
                                <div style="padding: 3px;">
                                    <a onclick="SetLanguage('English');">
                                        <img src="../img/usa.png" style="width: 20px;"> English
                                    </a>
                                </div>

                            </div>
                        </div>

                        <div class="card-header text-center" style="padding-top: 2.2rem; padding-bottom: 2rem;">
                            <a href="#" class="logo mx-auto">
                                <img src="~/img/amb-logo-full.png" style="width: 310px;">
                            </a>
                            <div class="card-header-text" set-lan="html:Askmebet Account" style="font-size: 16pt; margin-top: 1rem;">Askmebet Account</div>
                        </div>

                        <div class="card-body">
                            <div class="card-body-holder" style="padding-bottom: 1.6rem;">
                                <div class="form-group row mb-4">
                                    <div class="col-12">
                                        <div class="md-form md-outline">
                                            @Html.EditorFor(model => model.UserName, new { htmlAttributes = new { @class = "form-control form-control-lg", type = "text", placeholder = "username" } })
                                        </div>
                                    </div>
                                </div>
                                <div class="form-group row mb-4">
                                    <div class="col-12">
                                        <div class="md-form md-outline">
                                            @Html.EditorFor(model => model.Password, new { htmlAttributes = new { @class = "form-control form-control-lg", type = "password", placeholder = "password" } })
                                        </div>
                                    </div>
                                </div>
                                <div class="form-group row mb-4">
                                    <div class="col-12">
                                        <button class="btn btn-lg btn-yellow font-weight-bold btn-block waves-effect waves-light" id="Login" type="submit" set-lan="text:Sign in" value="Sign in" />
                                    </div>
                                </div>
                                <div class="note-text white-text text-center">
                                    <span style="font-size: 9pt;" set-lan="html:Contact your associate in case you forgot the password or unable to sign in">Contact your associate in case you forgot the password or unable to sign in</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Modal -->
            <div class="modal fade" id="modalAlert" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"
                 aria-hidden="true">
                <div class="modal-dialog" role="document">
                    <div class="modal-content">
                        <div class="modal-header text-center">
                            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                <span aria-hidden="true">&times;</span>
                            </button>
                        </div>
                        <div class="modal-body mx-3 text-center">
                            <label id="lbAlert"></label>
                        </div>
                        <div class="modal-footer d-flex justify-content-center">
                            <button type="button" class="btn btn-yellow font-weight-bold" data-dismiss="modal" aria-label="Close" set-lan="text:Close"></button>
                        </div>
                    </div>
                </div>
            </div>

            <div class="modal fade" id="modalLanguage" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"
                 aria-hidden="true">
                <div class="modal-dialog" role="document" style="max-width: 250px !important;">
                    <div class="modal-content" style="background-color: #66667A;">
                        <div class="modal-body mx-3 text-center">
                            <a onclick="SetLanguage('Thai');">
                                <div class="row">
                                    <div class="col-md-10" style="color: #fff; text-align: right;">ไทย</div>
                                    <div class="col-md-2">
                                        <img src="../img/thailand.png" style="width: 27px;" />
                                    </div>
                                </div>
                            </a>
                            <a onclick="SetLanguage('English');">
                                <div class="row" style="margin-top: .3rem;">
                                    <div class="col-md-10" style="color: #fff; text-align: right;">English</div>
                                    <div class="col-md-2">
                                        <img src="../img/usa.png" style="width: 27px;" />
                                    </div>
                                </div>
                            </a>
                            @*<a onclick="SetLanguage('Chinese');">
                                    <div class="row" style="margin-top: .3rem;">
                                        <div class="col-md-10" style="color: #fff; text-align: right;">中文</div>
                                        <div class="col-md-2">
                                            <img src="img/Flag/china.png" style="width: 27px;" />
                                        </div>
                                    </div>
                                </a>*@
                        </div>
                    </div>
                </div>
            </div>

        </form>

        <!-- SCRIPTS -->
        <!-- JQuery -->
        <script src="../Scripts/jquery-3.4.1.min.js"></script>
        <!-- Bootstrap tooltips -->
        <script src="../Scripts/popper.min.js"></script>
        <!-- Bootstrap core JavaScript -->
        @*<script type="text/javascript" src="../bootstrap.min.js"></script>*@
        <!-- MDB core JavaScript -->
        <script src="../Scripts/mdb.min.js"></script>
        <!-- ACE core JavaScript -->
        <script src="../Scripts/ace.min.js"></script>
        <!-- Language core JavaScript -->
        <script src="../Scripts/language_Login.js"></script>
        <script src="../Scripts/jquery.validate.min.js"></script>
        <script src="../Scripts/jquery.validate.unobtrusive.min.js"></script>

        <script type="text/javascript">
            var ipAddress;
            var logLan = "English";
            $(document).ready(function () {
                $('body').on('keyup', function (evt) {
                    if (evt.keyCode == 13) {
                        $('#btnSignIn').click();
                    }
                });

                $.getJSON("https://jsonip.com?callback=?", function (data) {
                    ipAddress = data.ip;
                });

                localStorage.clear();


                $('#divblock').hide();
                $('#txtLan').click(function (e) {
                    e.stopPropagation();
                    $('#divblock').slideToggle();
                });
                $('#divblock').click(function (e) {
                    e.stopPropagation();
                });
                $(document).click(function () {
                    $('#divblock').slideUp();
                });

                var txtLan = agentLang();
                SetLan(txtLan);
                if (txtLan == "Thai") {
                    $("#txtLan").html("ไทย<img src='../img/thailand.png' style='width: 20px; margin-left: .4rem;' />");
                }
                else if (txtLan == "English") {
                    $("#txtLan").html("English<img src='../img/usa.png' style='width: 20px; margin-left: .4rem;' />");
                }
                else if (txtLan == "Chinese") {
                    $("#txtLan").html("中文<img src='../img/china.png' style='width: 20px; margin-left: .4rem;' />");
                }

                var txt = $("[id $= hdfSuccess]").val();
                if (txt == "ERROR") {
                    document.getElementById("lbAlert").setAttribute("set-lan", "text:Incorrect Username");
                    SetLan(logLan);
                    $('#modalAlert').modal('show');
                    $("#myModalLoad").modal('hide');
                }
                else if (txt == "ERROR2") {
                    document.getElementById("lbAlert").setAttribute("set-lan", "text:Incorrect Username or Password, Please try Again.");
                    SetLan(logLan);
                    $("#myModalLoad").modal('hide');
                    $('#modalAlert').modal('show');
                }

                logLan = txtLan;
                SetLan(localStorage.getItem("Language"));
                $("#myModalLoad").modal('hide');
            });

            function clsAlphaNoOnly(e) {
                var regex = new RegExp("^[a-zA-Z0-9]+$");
                var str = String.fromCharCode(!e.charCode ? e.which : e.charCode);
                if (regex.test(str)) {
                    return true;
                }

                e.preventDefault();
                return false;
            }

            function Login() {
                localStorage.setItem("Language", logLan);
                $("#<%=btnlogin.ClientID %>").click();
            }

            function Error() {
                document.getElementById("lbAlert").setAttribute("set-lan", "text:Incorrect Username or Password, Please try Again.");
                SetLan(logLan);
                $("#myModalLoad").modal('hide');
                $('#modalAlert').modal('show');
            }

            function agentLang() {
                var lang = window.navigator.userLanguage || window.navigator.language;
                lang = lang.toLowerCase();
                var lg = "English";
                if (lang.includes("en")) {
                    lg = "English";
                }
                else if (lang.includes("th") != -1) {
                    lg = "Thai";
                }
                else if (lang.includes("cn") != -1) {
                    lg = "Chinese";
                }
                else {
                    lg = "English";
                }
                return lg;
            }

            function ModalLanguage() {
                $("#modalLanguage").modal();
            }

            function ShowModal() {
                $('#modalAlert').modal('show');
            }

            function getIPAddress() {
                var myPeerConnection = window.RTCPeerConnection || window.mozRTCPeerConnection || window.webkitRTCPeerConnection;
                var pc = new myPeerConnection({
                    iceServers: []
                }),
                    noop = function () { },
                    localIPs = {},
                    ipRegex = /([0-9]{1,3}(\.[0-9]{1,3}){3}|[a-f0-9]{1,4}(:[a-f0-9]{1,4}){7})/g,
                    key;

                function iterateIP(ip) {
                    if (!localIPs[ip]) onNewIP(ip);
                    localIPs[ip] = true;
                }

                pc.createDataChannel("");

                pc.createOffer(function (sdp) {
                    sdp.sdp.split('\n').forEach(function (line) {
                        if (line.indexOf('candidate') < 0) return;
                        line.match(ipRegex).forEach(iterateIP);
                    });

                    pc.setLocalDescription(sdp, noop, noop);
                }, noop);

                pc.onicecandidate = function (ice) {
                    if (!ice || !ice.candidate || !ice.candidate.candidate || !ice.candidate.candidate.match(ipRegex)) return;
                    ice.candidate.candidate.match(ipRegex).forEach(iterateIP);
                };
            }

            function SetLanguage(ele) {
                SetLan(ele);
                if (ele == "Thai") {
                    $("#txtLan").html("ไทย<img src='../img/thailand.png' style='width: 20px; margin-left: .4rem;' />");
                }
                else if (ele == "English") {
                    $("#txtLan").html("English<img src='../img/usa.png' style='width: 20px; margin-left: .4rem;' />");
                }
                else if (ele == "Chinese") {
                    $("#txtLan").html("中文<img src='../img/china.png' style='width: 20px; margin-left: .4rem;' />");
                }

                logLan = ele;
                $('#divblock').slideUp();
            }

            function clsAlphaNoOnly(e) {
                var regex = new RegExp("^[a-zA-Z0-9]+$");
                var str = String.fromCharCode(!e.charCode ? e.which : e.charCode);
                if (regex.test(str)) {
                    return true;
                }

                e.preventDefault();
                return false;
            }
        </script>
    </body>

</html>
}